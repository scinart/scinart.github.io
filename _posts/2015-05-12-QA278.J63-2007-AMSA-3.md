---
layout: post
title: "多元 笔记 (3)"
date: 2015-05-12
timestamp: "2015-05-13 14:28:34 scinart"
categories: math
tag: note
comments: false
toc: false
cc: "by-nc-nd"

---

为了避免矩阵与向量混淆，这里依然是向量用小写粗体表示，如 $$ \boldsymbol{x}$$，矩阵用大写粗体表示，如$$ \boldsymbol{X}$$。标量不加粗，如 $$\bar{x}_1$$，随机变量用大写不加粗，如 $$ X $$

## 样本几何

设随机向量 $$ \boldsymbol{x}_1, \boldsymbol{x}_2, \cdots, \boldsymbol{x}_n$$是来自同一个分布的样本，
样本共有$$p$$维，那么记

$$
\underset{n×p}{\boldsymbol{X}} = \begin{bmatrix}
 {x}_{11} & {x}_{12} &  \cdots & {x}_{1p} \\
 {x}_{21} & {x}_{22} &  \cdots & {x}_{2p} \\
 \vdots &  \vdots &  \ddots & \vdots \\
 {x}_{n1} & {x}_{n2} &  \cdots & {x}_{np} \\
\end{bmatrix} = \begin{bmatrix}
  \boldsymbol{x}_1^T \\
  \boldsymbol{x}_2^T \\
  \vdots \\
  \boldsymbol{x}_n^T \\
\end{bmatrix} = \begin{bmatrix}
  \boldsymbol{y}_1 & \boldsymbol{y}_2 & \cdots & \boldsymbol{y}_n
\end{bmatrix}
$$

记样本均值为

$$
\bar{\boldsymbol{x}} = \begin{bmatrix}
  \bar{x}_1 \\
  \bar{x}_2 \\
  \vdots    \\
  \bar{x}_p
\end{bmatrix} = \frac{1}{n}\sum_{i}{\boldsymbol{x}_i} = \frac{1}{n}\boldsymbol{X}^T \boldsymbol{1}_n
$$

为了方便，记

$$
\underset{n×1}{\boldsymbol{1}} = \begin{bmatrix}
  1 \\
  1 \\
  \vdots \\
  1
\end{bmatrix} = \boldsymbol{1}_n
$$

当维度没有歧义时，简记为 $$ \boldsymbol{1}$$

记 $$ \boldsymbol{d}_i = \boldsymbol{y}_i - \bar{x}_i \boldsymbol{1}$$，即$$ \boldsymbol{y}_i$$中除去平均值之后的部分。

记

$$
\underset{n×p}{\bar{\boldsymbol{X}}} = \boldsymbol{1}_n \bar{\boldsymbol{x}}^T \\

\boldsymbol{X} - \bar{\boldsymbol{X}} = \begin{bmatrix}
  \boldsymbol{d}_1 & \boldsymbol{d}_2 & \cdots & \boldsymbol{d}_n
\end{bmatrix}  \,\,\,\,\text{可恶，字母}\boldsymbol{D}被占用了\\

\boldsymbol{S}_n = \frac{1}{n}(\boldsymbol{X} - \bar{\boldsymbol{X}})^T (\boldsymbol{X} - \bar{\boldsymbol{X}}) = \frac{1}{n} \boldsymbol{X}^T\left( \boldsymbol{I} - \frac{1}{n} \boldsymbol{11}^T \right) \boldsymbol{X} \,\,\,\,\text{小推一下就行}
$$

所以$$ \boldsymbol{S}_n$$ 中的每一个元素为

$$
s_{ij} = \frac{1}{n} \boldsymbol{d}_i^T \boldsymbol{d}_j = \frac{1}{n}\sum_{k=1}^{n}{(x_{ki}-\bar{x}_i)(x_{kj}-\bar{x}_j)}
$$

记

$$

\boldsymbol{D} = \begin{bmatrix}
 {s}_{11} & 0 &  \cdots & 0\\
 0 & {s}_{22} &  \cdots & 0\\
 \vdots &  \vdots &  \ddots & \vdots \\
 0 & 0 &  \cdots & {s}_{pp} \\
\end{bmatrix} \\
r_{ij} = \frac{s_{ij}}{\sqrt{s_{ii}}\sqrt{s_{jj}}} \\
\boldsymbol{R} = \begin{bmatrix}
 {r}_{11} & {r}_{12} &  \cdots & {r}_{1p} \\
 {r}_{21} & {r}_{22} &  \cdots & {r}_{2p} \\
 \vdots &  \vdots &  \ddots & \vdots \\
 {r}_{p1} & {r}_{p2} &  \cdots & {r}_{pp} \\
\end{bmatrix}
$$

于是我们得到样本的均值$$\bar{\boldsymbol{x}}$$，方差协方差$$ \boldsymbol{S}_n$$, 
和样本相关系数 $$ \boldsymbol{R} = \boldsymbol{D}^{-1/2}\boldsymbol{SD}^{-1/2}$$

注意到对样本方差协方差的无偏估计是 $$ \boldsymbol{S} = \left(\frac{n}{n-1}\right)\boldsymbol{S}_n = \frac{1}{n-1}\sum_{k=1}^{n}{(x_{ki}-\bar{x}_i)(x_{kj}-\bar{x}_j)} $$
但是在统计中并不是很关心这些，见[知乎上的讨论](http://www.zhihu.com/question/20099757/answer/31842326)

## 变量的线性组合

考虑

$$
\boldsymbol{y} = \begin{bmatrix}
 {a}_{11}X_1 & + & {a}_{12}X_2 & + & \cdots & + & {a}_{1p}X_p \\
 {a}_{21}X_1 & + & {a}_{22}X_2 & + & \cdots & + & {a}_{2p}X_p \\
 \vdots      &   & \vdots      &   & \vdots &   & \vdots      \\
 {a}_{q1}X_1 & + & {a}_{q2}X_2 & + & \cdots & + & {a}_{qp}X_p
\end{bmatrix} = \begin{bmatrix}
 {a}_{11} & {a}_{12} &  \cdots & {a}_{1p} \\
 {a}_{21} & {a}_{22} &  \cdots & {a}_{2p} \\
 \vdots &  \vdots &  \ddots & \vdots \\
 {a}_{p1} & {a}_{p2} &  \cdots & {a}_{pp} \\
\end{bmatrix} \begin{bmatrix}
X_1 \\
X_2 \\
\vdots \\
X_p 
\end{bmatrix} = \underset{q×p}{\boldsymbol{A}} \underset{p×1}{\boldsymbol{x}}
$$

那么对样本，有

$$
\underset{n×q}{\boldsymbol{Y}} = \begin{bmatrix}
  (\boldsymbol{A}\boldsymbol{x}_1)^T \\
  (\boldsymbol{A}\boldsymbol{x}_2)^T \\
  \vdots \\
  (\boldsymbol{A}\boldsymbol{x}_n)^T \\
\end{bmatrix} = \boldsymbol{XA}^T
$$

其实写成$$ \boldsymbol{Y}^T = \boldsymbol{AX}^T$$更容易理解。

样本均值向量

$$
\begin{align}
\bar{\boldsymbol{y}} &= \frac{1}{n} \boldsymbol{Y}^T \boldsymbol{1}_n \\
                     &= \frac{1}{n} \boldsymbol{AX}^T \boldsymbol{1}_n \\
					 &= \boldsymbol{A} \bar{\boldsymbol{x}}
\end{align}
$$

样本方差协方差

$$
\begin{align}
\boldsymbol{S}_n &= \frac{1}{n} \boldsymbol{Y}^T\left( \boldsymbol{I} - \frac{1}{n} \boldsymbol{11}^T \right) \boldsymbol{Y} \\
                 &= \frac{1}{n} \boldsymbol{AX}^T\left( \boldsymbol{I} - \frac{1}{n} \boldsymbol{11}^T \right) \boldsymbol{XA}^T \\
                 &= \boldsymbol{A} \underset{of \boldsymbol{X}}{\boldsymbol{S}_n} \boldsymbol{A}^T
\end{align}
$$